[
  {
    "id": "SKIN-001",
    "category": "types",
    "description": "Add ArenaSkinId type and arenaSkin field to GameState in src/shared/types.ts",
    "steps_to_verify": [
      "Open src/shared/types.ts",
      "Verify ArenaSkinId type exists: 'default' | '4x4-grid'",
      "Find GameState interface",
      "Verify arenaSkin: ArenaSkinId field exists in interface"
    ],
    "passes": false
  },
  {
    "id": "SKIN-002",
    "category": "server",
    "description": "Add arenaSkin property and setArenaSkin() method to Game class in src/server/game.ts",
    "steps_to_verify": [
      "Open src/server/game.ts",
      "Verify arenaSkin: ArenaSkinId = 'default' property exists on Game class",
      "Verify setArenaSkin(skin: ArenaSkinId): void method exists"
    ],
    "passes": false
  },
  {
    "id": "SKIN-003",
    "category": "server",
    "description": "Include arenaSkin in Game broadcast() and getState() methods",
    "steps_to_verify": [
      "Open src/server/game.ts",
      "Find broadcast() method, verify state object includes arenaSkin: this.arenaSkin",
      "Find getState() method, verify returned object includes arenaSkin: this.arenaSkin"
    ],
    "passes": false
  },
  {
    "id": "SKIN-004",
    "category": "server",
    "description": "Add setArenaSkin() to ScriptRunner interface in src/server/encounters/types.ts",
    "steps_to_verify": [
      "Open src/server/encounters/types.ts",
      "Verify import of ArenaSkinId from shared types",
      "Find ScriptRunner interface",
      "Verify setArenaSkin(skin: ArenaSkinId): void method exists in interface"
    ],
    "passes": false
  },
  {
    "id": "SKIN-005",
    "category": "server",
    "description": "Implement setArenaSkin() in ScriptRunnerImpl in src/server/encounters/script-runner.ts",
    "steps_to_verify": [
      "Open src/server/encounters/script-runner.ts",
      "Verify import of ArenaSkinId from shared types",
      "Find ScriptRunnerImpl class",
      "Verify setArenaSkin() method exists and calls this.game.setArenaSkin(skin)"
    ],
    "passes": false
  },
  {
    "id": "SKIN-006",
    "category": "client",
    "description": "Create src/client/arenaSkins.ts with renderArenaSkin() and render4x4GridSkin() functions",
    "steps_to_verify": [
      "File src/client/arenaSkins.ts exists",
      "Verify renderArenaSkin(ctx: CanvasRenderingContext2D, skinId: ArenaSkinId) function is exported",
      "Verify render4x4GridSkin(ctx: CanvasRenderingContext2D) function exists",
      "Verify renderArenaSkin switches on skinId and calls render4x4GridSkin for '4x4-grid'"
    ],
    "passes": false
  },
  {
    "id": "SKIN-007",
    "category": "client",
    "description": "render4x4GridSkin draws faint gridlines at 200px intervals creating 4x4 grid",
    "steps_to_verify": [
      "Open src/client/arenaSkins.ts",
      "Verify GRID_INTERVAL = 200 constant or equivalent",
      "Verify strokeStyle is faint (alpha ~0.3, bluish color)",
      "Verify vertical lines at x = 200, 400, 600",
      "Verify horizontal lines at y = 200, 400, 600",
      "Verify ctx.save()/translate(ARENA_OFFSET)/restore() pattern for proper positioning"
    ],
    "passes": false
  },
  {
    "id": "SKIN-008",
    "category": "client",
    "description": "Update render() in src/client/renderer.ts to accept arenaSkin parameter and call renderArenaSkin()",
    "steps_to_verify": [
      "Open src/client/renderer.ts",
      "Verify import of renderArenaSkin from arenaSkins.ts",
      "Verify render() function has arenaSkin?: ArenaSkinId parameter",
      "Verify renderArenaSkin(ctx, arenaSkin) is called after clear() but before ctx.translate()"
    ],
    "passes": false
  },
  {
    "id": "SKIN-009",
    "category": "client",
    "description": "Update src/client/game.ts to include arenaSkin in initial state and pass to render()",
    "steps_to_verify": [
      "Open src/client/game.ts",
      "Verify initial currentGameState includes arenaSkin: 'default'",
      "Find render() call in gameLoop or similar",
      "Verify currentGameState.arenaSkin is passed to render()"
    ],
    "passes": false
  },
  {
    "id": "SKIN-010",
    "category": "script",
    "description": "Update quad-knock script to set arena skin to '4x4-grid' at start",
    "steps_to_verify": [
      "Open src/server/encounters/scripts/combos/quad-knock.ts",
      "Verify runner.setArenaSkin('4x4-grid') call exists near start of script"
    ],
    "passes": false
  },
  {
    "id": "SKIN-011",
    "category": "build",
    "description": "Project builds without TypeScript errors after all arena skin changes",
    "steps_to_verify": [
      "Run npm run build",
      "Verify no TypeScript compilation errors",
      "Verify build completes successfully"
    ],
    "passes": false
  },
  {
    "id": "SKIN-012",
    "category": "e2e",
    "description": "Full arena skin E2E validation: default state, quad-knock activation, draw order, and persistence",
    "steps_to_verify": [
      "Use Playwright to navigate to localhost:3000?debug=1 and join game",
      "Verify initial arenaSkin is 'default' via page.evaluate(() => __gameTest.getGameState().arenaSkin)",
      "Take screenshot - arena should have plain blue floor with no gridlines",
      "Run quad-knock via page.evaluate(() => __adminTest.emitRunQuadKnock())",
      "Wait for skin change, verify arenaSkin is '4x4-grid'",
      "Take screenshot - verify faint 4x4 gridlines at 200px intervals (3 vertical + 3 horizontal)",
      "Spawn chariot via admin button to verify draw order - player and mechanic render on top of gridlines",
      "Wait for quad-knock to complete, verify arenaSkin persists as '4x4-grid'",
      "Take final screenshot confirming gridlines still visible after script ends"
    ],
    "passes": false
  }
]
