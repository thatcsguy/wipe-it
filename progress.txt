TRIGGER-001: Added triggerAt?: number to all 8 MechanicParams union types
- chariot, spread, tether, tower, lineAoe, conalAoe, radialKnockback, linearKnockback
- Build passes
- File: src/server/encounters/types.ts

TRIGGER-002: ScriptRunnerImpl tracks script start time
- Added private field scriptStartTime: number
- Constructor sets this.scriptStartTime = Date.now()
- Added getElapsedTime() helper returning Date.now() - scriptStartTime
- Build passes
- File: src/server/encounters/script-runner.ts

TRIGGER-003: computeTiming() helper for triggerAt conversion
- Method signature: computeTiming(triggerAt, timing, defaultTiming, timingName) => number
- Returns defaultTiming when both undefined
- Returns timing when defined, triggerAt undefined
- Computes triggerAt - getElapsedTime() when triggerAt defined
- Also implements TRIGGER-004 and TRIGGER-005 error handling:
  - Throws "Cannot specify both triggerAt and {timingName}" when both defined
  - Throws with triggerAt/elapsed info when computed delay is negative
- Build passes
- File: src/server/encounters/script-runner.ts

TRIGGER-006: All 8 spawn() cases use computeTiming()
- chariot, spread, tether, tower, lineAoe, conalAoe use computeTiming for 'duration'
- radialKnockback, linearKnockback use computeTiming for 'delay'
- Build passes
- File: src/server/encounters/script-runner.ts

TRIGGER-006a: runner.run() creates new ScriptRunnerImpl for sub-scripts
- Changed run() to create `new ScriptRunnerImpl(this.game)` instead of reusing `this`
- Sub-script's T=0 is now when run() is called, not parent's start time
- Verified via Playwright: parent waits 3000ms, sub-script spawns with triggerAt:1500 succeeds
- Added test script: src/server/encounters/scripts/tests/scoped-timeline-test.ts
- Admin handler: socket.on('admin:runScopedTimelineTest')
- Build passes
- File: src/server/encounters/script-runner.ts, src/server/index.ts

TRIGGER-008: E2E test verifies triggerAt synchronizes mechanics to absolute time
- Test: spawns chariot at T=0 with triggerAt:3000, spawns second at T=1500 with triggerAt:3000
- Result: both resolve within 1ms of each other despite 1513ms spawn delta
- Mechanic 1 duration: 3025ms, Mechanic 2 duration: 1513ms - both resolve at T~3000
- Test script: src/server/encounters/scripts/tests/trigger-at-test.ts
- Admin handler: socket.on('admin:runTriggerAtTest')
- Client method: __adminTest.emitRunTriggerAtTest()
- Build passes
- Files: src/server/encounters/scripts/tests/trigger-at-test.ts, src/server/index.ts, src/client/admin.ts

TRIGGER-007: Migrated quad-knock.ts to use triggerAt
- Renamed FIRST_KNOCK_DELAY → FIRST_KNOCK_TRIGGER (9500), SECOND_KNOCK_DELAY → SECOND_KNOCK_TRIGGER (11000)
- spawnKnockback helper now takes triggerAt param instead of delay
- Updated timeline comment to emphasize absolute times
- Build passes
- File: src/server/encounters/scripts/combos/quad-knock.ts

TRIGGER-009: E2E test verifies quad-knock knockbacks trigger at correct absolute times
- Playwright test via browser_evaluate monitors mechanic lifecycle
- First pair spawns T~0, resolves T~9540ms (expected 9500ms, delta <50ms)
- Second pair spawns T~2000ms, resolves T~11040ms (expected 11000ms, delta <50ms)
- triggerAt correctly calculates delay: 9500-0=9500 for first pair, 11000-2000=9000 for second
- Verified player knockback state triggers at expected times
- No code changes needed - test confirms existing implementation works
